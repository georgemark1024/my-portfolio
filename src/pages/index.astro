---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { getCollection } from 'astro:content';
import { SITE_DESCRIPTION, SITE_TITLE, SITE_AUTHOR } from '../consts';

const projects = (await getCollection('projects')).filter(p => p.data.featured).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const recentPosts = (await getCollection('blog')).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()).slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.hero {
				padding: 4rem 0;
				text-align: center;
				background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
				border-radius: 8px;
				margin: 2rem 0;
			}

			.hero h1 {
				font-size: 2.5rem;
				margin-bottom: 1rem;
				color: #111111;
			}

			.hero p {
				font-size: 1.125rem;
				color: #878787;
				margin-bottom: 2rem;
				max-width: 600px;
				margin-left: auto;
				margin-right: auto;
			}

			.cta-buttons {
				display: flex;
				gap: 1rem;
				justify-content: center;
				flex-wrap: wrap;
			}

			.cta-button {
				padding: 0.75rem 1.5rem;
				border-radius: 6px;
				text-decoration: none;
				font-weight: 600;
				transition: all 0.3s ease;
				display: inline-block;
			}

			.cta-primary {
				background-color: #2f5ee9;
				color: white;
			}

			.cta-primary:hover {
				background-color: #1e3fa0;
				box-shadow: 0 4px 12px rgba(47, 94, 233, 0.3);
			}

			.cta-secondary {
				background-color: #f3f4f6;
				color: #111111;
				border: 1px solid #e5e7eb;
			}

			.cta-secondary:hover {
				background-color: #e5e7eb;
			}

			.section-title {
				font-size: 1.875rem;
				color: #111111;
				margin: 3rem 0 1.5rem 0;
				padding-bottom: 0.5rem;
				border-bottom: 2px solid #2f5ee911;
			}

			.projects-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
				gap: 1.5rem;
				margin: 2rem 0;
			}

			.project-card {
				background: white;
				border: 1px solid #e5e7eb;
				border-radius: 6px;
				padding: 1.5rem;
				transition: all 0.3s ease;
			}

			.project-card:hover {
				border-color: #2f5ee9;
				box-shadow: 0 4px 12px rgba(47, 94, 233, 0.1);
			}

			.project-card h3 {
				color: #111111;
				margin: 0 0 0.5rem 0;
			}

			.project-card p {
				color: #878787;
				margin: 0.5rem 0;
				line-height: 1.6;
			}

			.posts-list {
				display: grid;
				gap: 1.5rem;
				margin: 2rem 0;
			}

			.post-item {
				padding: 1.5rem;
				border: 1px solid #e5e7eb;
				border-radius: 6px;
				transition: all 0.3s ease;
			}

			.post-item:hover {
				border-color: #2f5ee9;
				background-color: #f9fafb;
			}

			.post-item h4 {
				color: #111111;
				margin: 0 0 0.5rem 0;
			}

			.post-item p {
				color: #878787;
				margin: 0;
				font-size: 0.95rem;
			}

			.view-all {
				display: inline-block;
				color: #2f5ee9;
				text-decoration: none;
				font-weight: 600;
				margin-top: 1rem;
			}

			.view-all:hover {
				text-decoration: underline;
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<section class="hero">
				<h1>Welcome to My Portfolio</h1>
				<p>
					I'm {SITE_AUTHOR}, a developer passionate about creating beautiful and functional digital experiences.
					Here you'll find my latest projects, insights, and thoughts on web development.
				</p>
				<div class="cta-buttons">
					<a href="/projects" class="cta-button cta-primary">View My Work</a>
					<a href="/blog" class="cta-button cta-secondary">Read My Blog</a>
				</div>
			</section>

			{projects.length > 0 && (
				<section>
					<h2 class="section-title">Featured Projects</h2>
					<div class="projects-grid">
						{projects.map(project => (
							<a href={`/projects/${project.id}/`} style="text-decoration: none; color: inherit;">
								<article class="project-card">
									<h3>{project.data.title}</h3>
									<p>{project.data.description}</p>
									<div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 1rem;">
										{project.data.technologies.slice(0, 3).map(tech => (
											<span style="background-color: #2f5ee911; color: #2f5ee9; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.875rem;">
												{tech}
											</span>
										))}
									</div>
									<span class="view-all" style="display: inline-block;">
										View Details →
									</span>
								</article>
							</a>
						))}
					</div>
					<a href="/projects" class="view-all" style="display: block; margin-top: 2rem;">View All Projects →</a>
				</section>
			)}

			{recentPosts.length > 0 && (
				<section>
					<h2 class="section-title">Latest Articles</h2>
					<div class="posts-list">
						{recentPosts.map(post => (
							<article class="post-item">
							<h4><a href={`/blog/${post.id}/`} style="color: #111111; text-decoration: none;">{post.data.title}</a></h4>
							<p>{post.data.description}</p>
							<a href={`/blog/${post.id}/`} class="view-all">Read More →</a>
							</article>
						))}
					</div>
					<a href="/blog" class="view-all" style="display: block; margin-top: 2rem;">View All Articles →</a>
				</section>
			)}
		</main>
		<Footer />
	</body>
</html>
